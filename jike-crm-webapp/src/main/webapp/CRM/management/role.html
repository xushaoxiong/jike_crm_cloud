<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Document</title>
	<link rel="stylesheet" href="css/bootstrap.min.css" />
	<script type="text/javascript" src="js/jquery-1.11.0.js" ></script>
	<script type="text/javascript" src="js/bootstrap.min.js" ></script>
	<script type="text/javascript" src="js/pub/pub.js" ></script>
</head>
<body>
	<style>
	.ZH-account button{
		margin-top: 20px;
	}
	.search-wap{
		padding: 20px 0;
	}
	.tableAccnt tr th{text-align: center;}
	.pagination-wap{
		line-height: 80px;
	}
	.total-page{
		padding-right: 15px;
	}
	#MRole input{
		margin-bottom: 8px;
	}
</style>

<div class="ZH-account clearfix" style="width: 95%;">
	<h3 class="title pull-left">角色管理</h3>
	<button class="btn btn-primary pull-right addBtn"><span class="glyphicon glyphicon-plus"></span>创建角色</button>
</div>
<table class="table table-bordered text-center table-responsive tableAccnt">
	<thead>
		<tr>
			<th>角色编号</th>
			<th>角色名称</th>
			<th>创建时间</th>
			<th>修改时间</th>
			<th>操作</th>
		</tr>
	</thead>
	<tbody id="role-wap">
		<!--<tr>
			<td class="rolenum">001</td>
			<td class="rolename">管理员</td>
			<td>2016/9/25 18:20:49</td>
			<td>2016/9/26 08:20:49</td>
			<td>
				<a class="edit">修改</a>
				<a class="del">删除</a>
			</td>
		</tr>
		<tr>
			<td class="rolenum">002</td>
			<td class="rolename">管理员2</td>
			<td>2016/9/25 18:20:49</td>
			<td>2016/9/26 08:20:49</td>
			<td>
				<a class="edit">修改</a>
				<a class="del">删除</a>
			</td>
		</tr>
		<tr>
			<td class="rolenum">003</td>
			<td class="rolename">管理员3</td>
			<td>2016/9/25 18:20:49</td>
			<td>2016/9/26 08:20:49</td>
			<td>
				<a class="edit">修改</a>
				<a class="del">删除</a>
			</td>
		</tr>
		<tr>
			<td>001</td>
			<td>管理员</td>
			<td>2016/9/25 18:20:49</td>
			<td>2016/9/26 08:20:49</td>
			<td>
				<a>修改</a>
				<a>删除</a>
			</td>
		</tr>
		<tr>
			<td>001</td>
			<td>管理员</td>
			<td>2016/9/25 18:20:49</td>
			<td>2016/9/26 08:20:49</td>
			<td>
				<a>修改</a>
				<a>删除</a>
			</td>
		</tr>-->
	</tbody>
</table>
	<!--新增、修改弹框-->
<div class="modal fade" id="MRole">
	<div class="modal-dialog modal-sm">
		<div class="modal-content form-inline">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
				<h4>创建角色</h4>
			</div>
			<div class="modal-body">
				<p class="text-danger text-center RoleStats"></p>
				<div class="form-group">
					<label>角色编号：</label>
					<input type="text" placeholder="编号" class="form-control" id="roleNum"/>
				</div>
				<div class="form-group">
					<label>角色名称：</label>
					<input type="text" placeholder="名称" class="form-control" id="roleName"/>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
	            <button type="button" class="btn btn-primary confirm">保存</button>
			</div>
		</div>
	</div>
</div>

</body>
<script>
	//角色列表
	function roleList(){
		$.ajax({
		type:"post",
		contentType: "application/json; charset=utf-8",
		url:ajaxUrl+'role/queryRole',
		data:'{"roleId":2}',
		dataType:'json',
		success:function(jo){
			var RoleHtml="";
			$.each(jo, function(i,item) {
				RoleHtml+='<tr>';
					RoleHtml+='<td class="RoleName">'+item.roleNum+'</td>';
					RoleHtml+='<td class="RoleName" roleId="'+item.roleId+'">'+item.roleName+'</td>';
					RoleHtml+='<td>'+item.createTime+'</td>';
					RoleHtml+='<td>'+item.updateTime+'</td>';
					RoleHtml+='<td>';
						RoleHtml+='<a style="padding-right:5px;" class="edit">修改</a>';
						RoleHtml+='<a class="del">删除</a>';
					RoleHtml+='</td>';
				RoleHtml+='</tr>';
			});
			$('#role-wap').html(RoleHtml);
		}
	});
	}roleList()
	
//新增弹框
	$('.addBtn').click(function(){
		$("#MRole").modal("toggle");
		$('#roleNum').val('');
		$('#roleName').val('');
	})
	//添加角色
	$('.confirm').click(function(){
		var roleJ={};
		var roleNum=$('#roleNum').val();
		var roleName=$('#roleName').val();
		roleJ.roleNum=roleNum;
		roleJ.roleName=roleName;
		$.ajax({
			type:"post",
			contentType: "application/json; charset=utf-8",
			url:ajaxUrl+"role/addRole",
			dataType:'json',
			data:JSON.stringify(roleJ),
			success:function(jo){
				if(jo.status=='success'){
					$('#MRole').modal('hide');
					roleList();
				}else{
					$('.RoleStats').html('该角色已存在!');
				}
			}
		});
	})
	//修改
	$(document).on('click','.edit',function(){
		$("#MRole").modal("toggle");
		var RoleName=$(this).parents('tr').find('.rolename').html();
		var RoleNum=$(this).parents('tr').find('.rolenum').html();
		$('#roleNum').val(RoleName);
		$('#roleName').val(RoleNum);
		roleList();
	})
	//删除
	$(document).on('click','.del',function(){
		var tr=$(this).parents('tr');
		pub.Alt('确定删除该项？',true,function(){
			$('.confirm').click(function(){
				tr.remove();
				$('.alert-del').hide();
			})
		})
	})

</script>
</html>



